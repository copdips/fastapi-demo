from sqlmodel.ext.asyncio.session import AsyncSession

from app_domain_based.app_tag.models import Tag
from app_domain_based.app_team.models import Team
from app_domain_based.app_user.models import User


async def create_init_data(async_session_factory: type[AsyncSession]):
    async with async_session_factory() as session:
        tag_admin = Tag(name="admin")
        tag_reader = Tag(name="reader")
        tag_contributor = Tag(name="contributor")
        team_preventers = Team(
            name="Preventers",
            headquarters="Sharp Tower",
            tags=[tag_admin, tag_reader, tag_contributor],
        )
        team_z_force = Team(
            name="Z-Force",
            headquarters="Sister Margaret's Bar",
            tags=[tag_reader],
        )
        team_empty = Team(name="empty", headquarters="without users")
        session.add(team_preventers)
        session.add(team_z_force)
        session.add(team_empty)
        # commit is not a must have if the team.id generated by Python before commit.
        # await session.commit()

        user_deadpond = User(
            name="Deadpond",
            first_name="Dive",
            last_name="Wilson",
            email="Deadpond@local.com",
            team=team_z_force,
        )
        user_a = User(
            name="a",
            first_name="b",
            last_name="c",
            email="a@local.com",
            team=team_z_force,
        )
        user_rusty_man = User(
            name="Rusty-Man",
            first_name="Tommy",
            last_name="Sharp",
            email="Rusty-Man@local.com",
            team=team_preventers,
        )
        user_spider_boy = User(
            name="Spider-Boy",
            first_name="Pedro",
            last_name="Parqueador",
            email="Spider-Boy@local.com",
        )
        session.add(user_deadpond)
        session.add(user_a)
        session.add(user_rusty_man)
        session.add(user_spider_boy)
        await session.commit()
